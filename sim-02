#! /opt/homebrew/Cellar/icarus-verilog/12.0/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/system.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/vhdl_sys.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/vhdl_textio.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/v2005_math.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/va_math.vpi";
:vpi_module "/opt/homebrew/Cellar/icarus-verilog/12.0/lib/ivl/v2009.vpi";
S_0x1015c2730 .scope package, "$unit" "$unit" 2 1;
 .timescale 0 0;
S_0x1015c3a30 .scope module, "sine_quant_tb" "sine_quant_tb" 3 3;
 .timescale -9 -12;
v0x8f9424fa0_0 .var/real "Fs", 0 0;
v0x8f9425040_0 .var/real "Ts", 0 0;
v0x8f94250e0_0 .var/real "f", 0 0;
v0x8f9425180_0 .var/real "pi", 0 0;
v0x8f9425220 .array/real "samples", 47999 0;
S_0x1015c3bb0 .scope task, "generateErrors" "generateErrors" 3 72, 3 72 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x1015c2900_0 .var/i "F", 31 0;
v0x1015b4cb0_0 .var/i "I", 31 0;
v0x1015b4d50_0 .var/i "err_file", 31 0;
v0x1015c3d30_0 .var/str "err_fname";
v0x1015c3dd0_0 .var/real "error", 0 0;
v0x1015c3e70_0 .var/i "i", 31 0;
v0x1015c3f10_0 .var/i "q_file", 31 0;
v0x1015c3fb0_0 .var/str "q_fname";
v0x1015c4050 .array/real "quantized", 47999 0;
TD_sine_quant_tb.generateErrors ;
    %vpi_func/s 3 79 "$sformatf", "q_%0d_%0d_verilog.txt", v0x1015b4cb0_0, v0x1015c2900_0 {0 0 0};
    %store/str v0x1015c3fb0_0;
    %vpi_func/s 3 80 "$sformatf", "err_q_%0d_%0d.txt", v0x1015b4cb0_0, v0x1015c2900_0 {0 0 0};
    %store/str v0x1015c3d30_0;
    %vpi_func 3 81 "$fopen" 32, v0x1015c3fb0_0, "r" {0 0 0};
    %store/vec4 v0x1015c3f10_0, 0, 32;
    %load/vec4 v0x1015c3f10_0;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_0.0, 4;
    %vpi_call/w 3 84 "$display", "Can't open file %s", v0x1015c3fb0_0 {0 0 0};
T_0.0 ;
    %vpi_func 3 87 "$fopen" 32, v0x1015c3d30_0, "w" {0 0 0};
    %store/vec4 v0x1015b4d50_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x1015c3e70_0, 0, 32;
T_0.2 ;
    %load/vec4 v0x1015c3e70_0;
    %cmpi/s 48000, 0, 32;
    %jmp/0xz T_0.3, 5;
    %vpi_func 3 90 "$fscanf" 32, v0x1015c3f10_0, "%f", &A<v0x1015c4050, v0x1015c3e70_0 > {0 0 0};
    %cmpi/ne 1, 0, 32;
    %jmp/0xz  T_0.4, 4;
    %load/vec4 v0x1015c3e70_0;
    %addi 1, 0, 32;
    %vpi_call/w 3 91 "$display", "Couldn't read value at line %0d", S<0,vec4,s32> {1 0 0};
    %vpi_call/w 3 92 "$fclose", v0x1015c3f10_0 {0 0 0};
T_0.4 ;
    %ix/getv/s 4, v0x1015c3e70_0;
    %load/ar v0x8f9425220, 4;
    %ix/getv/s 4, v0x1015c3e70_0;
    %load/ar v0x1015c4050, 4;
    %sub/wr;
    %store/real v0x1015c3dd0_0;
    %vpi_call/w 3 95 "$fwrite", v0x1015b4d50_0, "%0.20f\012", v0x1015c3dd0_0 {0 0 0};
    %load/vec4 v0x1015c3e70_0;
    %addi 1, 0, 32;
    %store/vec4 v0x1015c3e70_0, 0, 32;
    %jmp T_0.2;
T_0.3 ;
    %vpi_call/w 3 98 "$fclose", v0x1015b4d50_0 {0 0 0};
    %vpi_call/w 3 99 "$fclose", v0x1015c3f10_0 {0 0 0};
    %end;
S_0x1015c40f0 .scope task, "generateQuantizedValues" "generateQuantizedValues" 3 53, 3 53 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x1015c4270_0 .var/i "F", 31 0;
v0x1015c4310_0 .var/i "I", 31 0;
v0x1015c43b0_0 .var/i "file", 31 0;
v0x8f9424000_0 .var/str "fname";
v0x8f94240a0_0 .var/i "i", 31 0;
v0x8f9424140_0 .var/real "quantizedVal", 0 0;
TD_sine_quant_tb.generateQuantizedValues ;
    %vpi_func/s 3 59 "$sformatf", "q_%0d_%0d_verilog.txt", v0x1015c4310_0, v0x1015c4270_0 {0 0 0};
    %store/str v0x8f9424000_0;
    %vpi_func 3 60 "$fopen" 32, v0x8f9424000_0, "w" {0 0 0};
    %store/vec4 v0x1015c43b0_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x8f94240a0_0, 0, 32;
T_1.6 ;
    %load/vec4 v0x8f94240a0_0;
    %cmpi/s 48000, 0, 32;
    %jmp/0xz T_1.7, 5;
    %ix/getv/s 4, v0x8f94240a0_0;
    %load/ar v0x8f9425220, 4;
    %load/vec4 v0x1015c4310_0;
    %load/vec4 v0x1015c4270_0;
    %store/vec4 v0x8f94241e0_0, 0, 32;
    %store/vec4 v0x8f9424280_0, 0, 32;
    %store/real v0x8f94245a0_0;
    %callf/real TD_sine_quant_tb.quantize, S_0x1015c4450;
    %store/real v0x8f9424140_0;
    %vpi_call/w 3 64 "$fwrite", v0x1015c43b0_0, "%0.20f\012", v0x8f9424140_0 {0 0 0};
    %load/vec4 v0x8f94240a0_0;
    %addi 1, 0, 32;
    %store/vec4 v0x8f94240a0_0, 0, 32;
    %jmp T_1.6;
T_1.7 ;
    %vpi_call/w 3 67 "$fclose", v0x1015c43b0_0 {0 0 0};
    %end;
S_0x1015c4450 .scope function.real, "quantize" "quantize" 3 38, 3 38 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x8f94241e0_0 .var/i "F", 31 0;
v0x8f9424280_0 .var/i "I", 31 0;
; Variable quantize is REAL return value of scope S_0x1015c4450
v0x8f94243c0_0 .var/i "rounded", 31 0;
v0x8f9424460_0 .var/real "scale", 0 0;
v0x8f9424500_0 .var/real "scaled", 0 0;
v0x8f94245a0_0 .var/real "x", 0 0;
TD_sine_quant_tb.quantize ;
    %pushi/real 1073741824, 4067; load=2.00000
    %load/vec4 v0x8f94241e0_0;
    %cvt/rv/s;
    %pow/wr;
    %store/real v0x8f9424460_0;
    %load/real v0x8f94245a0_0;
    %load/real v0x8f9424460_0;
    %mul/wr;
    %store/real v0x8f9424500_0;
    %load/real v0x8f9424500_0;
    %store/real v0x8f94248c0_0;
    %callf/vec4 TD_sine_quant_tb.real_to_int, S_0x1015c47f0;
    %store/vec4 v0x8f94243c0_0, 0, 32;
    %load/vec4 v0x8f94243c0_0;
    %cvt/rv/s;
    %load/real v0x8f9424460_0;
    %div/wr;
    %ret/real 0; Assign to quantize
    %end;
S_0x1015c4620 .scope task, "readSamples" "readSamples" 3 12, 3 12 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x8f9424640_0 .var/i "file", 31 0;
v0x8f94246e0_0 .var/i "i", 31 0;
TD_sine_quant_tb.readSamples ;
    %vpi_func 3 15 "$fopen" 32, "samples.txt", "r" {0 0 0};
    %store/vec4 v0x8f9424640_0, 0, 32;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x8f94246e0_0, 0, 32;
T_3.8 ;
    %load/vec4 v0x8f94246e0_0;
    %cmpi/s 48000, 0, 32;
    %jmp/0xz T_3.9, 5;
    %vpi_call/w 3 16 "$fscanf", v0x8f9424640_0, "%f", &A<v0x8f9425220, v0x8f94246e0_0 > {0 0 0};
    ; show_stmt_assign_vector: Get l-value for compressed += operand
    %load/vec4 v0x8f94246e0_0;
    %pushi/vec4 1, 0, 32;
    %add;
    %store/vec4 v0x8f94246e0_0, 0, 32;
    %jmp T_3.8;
T_3.9 ;
    %vpi_call/w 3 17 "$fclose", v0x8f9424640_0 {0 0 0};
    %end;
S_0x1015c47f0 .scope function.vec4.u32, "real_to_int" "real_to_int" 3 21, 3 21 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x8f9424780_0 .var/real "frac", 0 0;
v0x8f9424820_0 .var/i "int_num", 31 0;
v0x8f94248c0_0 .var/real "num", 0 0;
; Variable real_to_int is vec4 return value of scope S_0x1015c47f0
TD_sine_quant_tb.real_to_int ;
    %load/real v0x8f94248c0_0;
    %cvt/vr 32;
    %store/vec4 v0x8f9424820_0, 0, 32;
    %load/real v0x8f94248c0_0;
    %load/vec4 v0x8f9424820_0;
    %cvt/rv/s;
    %sub/wr;
    %store/real v0x8f9424780_0;
    %pushi/real 1073741824, 4065; load=0.500000
    %load/real v0x8f9424780_0;
    %cmp/wr;
    %flag_or 5, 4;
    %jmp/0xz  T_4.10, 5;
    %load/vec4 v0x8f9424820_0;
    %addi 1, 0, 32;
    %ret/vec4 0, 0, 32;  Assign to real_to_int (store_vec4_to_lval)
    %jmp T_4.11;
T_4.10 ;
    %load/vec4 v0x8f9424820_0;
    %ret/vec4 0, 0, 32;  Assign to real_to_int (store_vec4_to_lval)
T_4.11 ;
    %end;
S_0x1015c49c0 .scope function.real, "sqnrDb" "sqnrDb" 3 104, 3 104 0, S_0x1015c3a30;
 .timescale -9 -12;
v0x8f9424a00_0 .var/i "F", 31 0;
v0x8f9424aa0_0 .var/i "I", 31 0;
v0x8f9424b40_0 .var/real "errorVal", 0 0;
v0x8f9424be0_0 .var/real "error_power", 0 0;
v0x8f9424c80_0 .var/i "file", 31 0;
v0x8f9424d20_0 .var/str "fname";
v0x8f9424dc0_0 .var/i "i", 31 0;
v0x8f9424e60_0 .var/real "signal_power", 0 0;
; Variable sqnrDb is REAL return value of scope S_0x1015c49c0
TD_sine_quant_tb.sqnrDb ;
    %vpi_func/s 3 112 "$sformatf", "err_q_%0d_%0d.txt", v0x8f9424aa0_0, v0x8f9424a00_0 {0 0 0};
    %store/str v0x8f9424d20_0;
    %vpi_func 3 113 "$fopen" 32, v0x8f9424d20_0, "r" {0 0 0};
    %store/vec4 v0x8f9424c80_0, 0, 32;
    %load/vec4 v0x8f9424c80_0;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_5.12, 4;
    %vpi_call/w 3 116 "$display", "Can't open file %s", v0x8f9424d20_0 {0 0 0};
T_5.12 ;
    %pushi/real 0, 4065; load=0.00000
    %store/real v0x8f9424e60_0;
    %pushi/real 0, 4065; load=0.00000
    %store/real v0x8f9424be0_0;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x8f9424dc0_0, 0, 32;
T_5.14 ;
    %load/vec4 v0x8f9424dc0_0;
    %cmpi/s 48000, 0, 32;
    %jmp/0xz T_5.15, 5;
    %vpi_func 3 123 "$fscanf" 32, v0x8f9424c80_0, "%f", v0x8f9424b40_0 {0 0 0};
    %cmpi/ne 1, 0, 32;
    %jmp/0xz  T_5.16, 4;
    %load/vec4 v0x8f9424dc0_0;
    %addi 1, 0, 32;
    %vpi_call/w 3 124 "$display", "Error reading from file %s at line %0d", v0x8f9424d20_0, S<0,vec4,s32> {1 0 0};
    %vpi_call/w 3 125 "$fclose", v0x8f9424c80_0 {0 0 0};
T_5.16 ;
    ; show_stmt_assign_real: Get l-value for compressed += operand
    %load/real v0x8f9424e60_0;
    %ix/getv/s 4, v0x8f9424dc0_0;
    %load/ar v0x8f9425220, 4;
    %ix/getv/s 4, v0x8f9424dc0_0;
    %load/ar v0x8f9425220, 4;
    %mul/wr;
    %add/wr;
    %store/real v0x8f9424e60_0;
    ; show_stmt_assign_real: Get l-value for compressed += operand
    %load/real v0x8f9424be0_0;
    %load/real v0x8f9424b40_0;
    %load/real v0x8f9424b40_0;
    %mul/wr;
    %add/wr;
    %store/real v0x8f9424be0_0;
    %load/vec4 v0x8f9424dc0_0;
    %addi 1, 0, 32;
    %store/vec4 v0x8f9424dc0_0, 0, 32;
    %jmp T_5.14;
T_5.15 ;
    ; show_stmt_assign_real: Get l-value for compressed /= operand
    %load/real v0x8f9424e60_0;
    %pushi/real 1572864000, 4081; load=48000.0
    %div/wr;
    %store/real v0x8f9424e60_0;
    ; show_stmt_assign_real: Get l-value for compressed /= operand
    %load/real v0x8f9424be0_0;
    %pushi/real 1572864000, 4081; load=48000.0
    %div/wr;
    %store/real v0x8f9424be0_0;
    %vpi_call/w 3 134 "$display", "Signal-Power, Error-Power: %0.15f %0.15f", v0x8f9424e60_0, v0x8f9424be0_0 {0 0 0};
    %load/real v0x8f9424e60_0;
    %load/real v0x8f9424be0_0;
    %div/wr;
    %vpi_func/r 3 135 "$log10", W<0,r> {0 1 0};
    %pushi/vec4 10, 0, 32;
    %cvt/rv/s;
    %mul/wr;
    %ret/real 0; Assign to sqnrDb
    %end;
    .scope S_0x1015c3a30;
T_6 ;
    %pushi/real 1572864000, 4081; load=48000.0
    %store/real v0x8f9424fa0_0;
    %pushi/real 2097152000, 4075; load=1000.00
    %store/real v0x8f94250e0_0;
    %pushi/real 1686629713, 4067; load=3.14159
    %pushi/real 273688, 4045; load=3.14159
    %add/wr;
    %store/real v0x8f9425180_0;
    %pushi/real 1466015503, 4050; load=2.08333e-05
    %pushi/real 2941605, 4028; load=2.08333e-05
    %add/wr;
    %store/real v0x8f9425040_0;
    %end;
    .thread T_6, $init;
    .scope S_0x1015c3a30;
T_7 ;
    %fork TD_sine_quant_tb.readSamples, S_0x1015c4620;
    %join;
    %pushi/vec4 3, 0, 32;
    %store/vec4 v0x1015c4310_0, 0, 32;
    %pushi/vec4 14, 0, 32;
    %store/vec4 v0x1015c4270_0, 0, 32;
    %fork TD_sine_quant_tb.generateQuantizedValues, S_0x1015c40f0;
    %join;
    %pushi/vec4 15, 0, 32;
    %store/vec4 v0x1015c4310_0, 0, 32;
    %pushi/vec4 2, 0, 32;
    %store/vec4 v0x1015c4270_0, 0, 32;
    %fork TD_sine_quant_tb.generateQuantizedValues, S_0x1015c40f0;
    %join;
    %pushi/vec4 8, 0, 32;
    %store/vec4 v0x1015c4310_0, 0, 32;
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x1015c4270_0, 0, 32;
    %fork TD_sine_quant_tb.generateQuantizedValues, S_0x1015c40f0;
    %join;
    %pushi/vec4 3, 0, 32;
    %store/vec4 v0x1015b4cb0_0, 0, 32;
    %pushi/vec4 14, 0, 32;
    %store/vec4 v0x1015c2900_0, 0, 32;
    %fork TD_sine_quant_tb.generateErrors, S_0x1015c3bb0;
    %join;
    %pushi/vec4 15, 0, 32;
    %store/vec4 v0x1015b4cb0_0, 0, 32;
    %pushi/vec4 2, 0, 32;
    %store/vec4 v0x1015c2900_0, 0, 32;
    %fork TD_sine_quant_tb.generateErrors, S_0x1015c3bb0;
    %join;
    %pushi/vec4 8, 0, 32;
    %store/vec4 v0x1015b4cb0_0, 0, 32;
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x1015c2900_0, 0, 32;
    %fork TD_sine_quant_tb.generateErrors, S_0x1015c3bb0;
    %join;
    %pushi/vec4 3, 0, 32;
    %pushi/vec4 14, 0, 32;
    %store/vec4 v0x8f9424a00_0, 0, 32;
    %store/vec4 v0x8f9424aa0_0, 0, 32;
    %callf/real TD_sine_quant_tb.sqnrDb, S_0x1015c49c0;
    %vpi_call/w 3 150 "$display", "SQNR Q(3,14) = %0.15f dB", W<0,r> {0 1 0};
    %pushi/vec4 15, 0, 32;
    %pushi/vec4 2, 0, 32;
    %store/vec4 v0x8f9424a00_0, 0, 32;
    %store/vec4 v0x8f9424aa0_0, 0, 32;
    %callf/real TD_sine_quant_tb.sqnrDb, S_0x1015c49c0;
    %vpi_call/w 3 151 "$display", "SQNR Q(15,2) = %0.15f dB", W<0,r> {0 1 0};
    %pushi/vec4 8, 0, 32;
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x8f9424a00_0, 0, 32;
    %store/vec4 v0x8f9424aa0_0, 0, 32;
    %callf/real TD_sine_quant_tb.sqnrDb, S_0x1015c49c0;
    %vpi_call/w 3 152 "$display", "SQNR Q(8,4) = %0.15f dB", W<0,r> {0 1 0};
    %vpi_call/w 3 154 "$finish" {0 0 0};
    %end;
    .thread T_7;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "-";
    "main-02.v";
